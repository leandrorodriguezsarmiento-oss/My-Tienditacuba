<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>VIPCELLUNLOCK | Premium Technology</title>
    <style>
        :root {
            --gold: #d4af37;
            --dark: #121212;
            --bg: #f5f5f7;
            --white: #ffffff;
            --whatsapp: #25d366;
            --red: #ff3b30;
        }

        body {
            font-family: -apple-system, system-ui, sans-serif;
            margin: 0; background: var(--bg); color: #333;
            padding-bottom: 100px;
        }

        .menu-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: var(--gold);
            border: 1px solid var(--gold);
            width: 45px;
            height: 45px;
            border-radius: 10px;
            cursor: pointer;
            z-index: 2000;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .admin-panel {
            position: fixed;
            top: 75px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: none;
            z-index: 2000;
            border: 1px solid var(--gold);
            width: 250px;
        }

        header {
            background: #000;
            color: white;
            text-align: center;
            padding: 60px 20px;
            border-bottom: 4px solid var(--gold);
        }

        .lock-icon { font-size: 50px; color: var(--gold); display: block; margin-bottom: 10px; }
        header h1 { font-size: 2.3rem; margin: 0; letter-spacing: 2px; color: var(--gold); }

        .tabs { display: flex; justify-content: center; background: white; border-bottom: 1px solid #d2d2d7; padding: 10px 0; position: sticky; top: 0; z-index: 1000; }
        .tab-btn { border: none; background: none; padding: 10px 20px; font-size: 16px; cursor: pointer; font-weight: 600; border-radius: 20px; }
        .tab-btn.active { background: var(--gold); color: black; }

        .container { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; padding: 30px 20px; max-width: 1100px; margin: auto; }
        .card { background: white; border-radius: 20px; padding: 25px; text-align: center; box-shadow: 0 5px 20px rgba(0,0,0,0.05); border: 1px solid #eee; position: relative; }
        .card img { width: 100%; height: 180px; object-fit: contain; margin-bottom: 15px; }

        .price { font-size: 1.5rem; font-weight: 700; color: #000; display: block; margin: 10px 0; }
        .btn-add { background: var(--dark); color: var(--gold); border: 1px solid var(--gold); width: 100%; padding: 12px; border-radius: 10px; font-weight: bold; cursor: pointer; }

        .cart-float { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: white; width: 90%; max-width: 400px; border-radius: 25px; box-shadow: 0 10px 50px rgba(0,0,0,0.3); padding: 25px; display: none; z-index: 3000; border: 2px solid var(--gold); }
        .cart-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-size: 14px; }
        .remove-btn { color: var(--red); cursor: pointer; font-weight: bold; font-size: 18px; margin-left: 10px; }

        footer { text-align: center; padding: 40px 20px; background: #000; color: #86868b; margin-top: 50px; }
        footer a { color: var(--gold); text-decoration: none; font-size: 14px; }

        .edit-mode .admin-fields { display: block; background: #fff9e6; padding: 10px; margin-top: 10px; border-radius: 10px; border: 1px dashed var(--gold); }
        .admin-fields { display: none; }
        input { width: 90%; padding: 10px; margin: 5px 0; border: 1px solid #ddd; border-radius: 8px; }
    </style>
</head>
<body>

<button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>

<div class="admin-panel" id="adminPanel">
    <button onclick="accessAdmin()" style="width:100%; padding:10px; margin-bottom:10px; background:black; color:var(--gold); border:1px solid var(--gold); border-radius:8px; cursor:pointer;">üîì Desbloquear Edici√≥n</button>
    <div id="editButtons" style="display:none;">
        <button onclick="newItem()" style="width:100%; padding:10px; margin-bottom:10px; background:#2ecc71; color:white; border:none; border-radius:8px;">+ A√±adir Item</button>
        <button onclick="saveAll()" style="width:100%; padding:10px; background:#0071e3; color:white; border:none; border-radius:8px;">üíæ Guardar Cambios</button>
    </div>
</div>

<header>
    <span class="lock-icon">üîê</span>
    <h1 id="s-name">VIPCELLUNLOCK</h1>
    <p>Premium Tech & Solutions</p>
</header>

<div class="tabs">
    <button class="tab-btn active" onclick="switchTab('prod', this)">Productos</button>
    <button class="tab-btn" onclick="switchTab('serv', this)">Servicios</button>
</div>

<div class="container" id="grid"></div>

<div class="cart-float" id="cart">
    <div style="font-weight: bold; text-align: center; margin-bottom: 15px;">RESUMEN DE PEDIDO</div>
    <div id="cart-items"></div>
    <div style="display: flex; justify-content: space-between; font-weight: bold; margin-top: 15px; font-size: 1.2rem; border-top: 1px solid #eee; padding-top: 10px;">
        <span>Total:</span><span id="cart-total">$0.00</span>
    </div>
    <input type="text" id="c-name" placeholder="Tu Nombre" style="margin-top:15px;">
    <button onclick="send()" style="background:var(--whatsapp); color:white; border:none; width:100%; padding:15px; border-radius:12px; font-weight:bold; cursor:pointer; margin-top:10px;">PEDIR POR WHATSAPP</button>
</div>

<footer>
    <p>¬© 2026 VIPCELLUNLOCK</p>
    <a href="https://leandrorodriguezsarmiento-oss.github.io/My-Tienditacuba/">https://leandrorodriguezsarmiento-oss.github.io/My-Tienditacuba/</a>
</footer>

<script>
    const tel = "5356530329";
    const PIN = "1977";
    let isEdit = false;
    let tab = 'prod';
    let cart = {};

    let db = JSON.parse(localStorage.getItem('vip_db_v2')) || {
        prod: [{id: 1, n: "iPhone 15", p: 1000, i: "https://via.placeholder.com/300", s: 5}],
        serv: [{id: 2, n: "Unlock iCloud", p: 50, i: "https://via.placeholder.com/300"}]
    };

    function toggleMenu() {
        const p = document.getElementById('adminPanel');
        p.style.display = p.style.display === 'block' ? 'none' : 'block';
    }

    function accessAdmin() {
        if(isEdit) { toggleEdit(); return; }
        const entered = prompt("PIN de Acceso:");
        if(entered === PIN) toggleEdit();
    }

    function toggleEdit() {
        isEdit = !isEdit;
        document.getElementById('editButtons').style.display = isEdit ? 'block' : 'none';
        document.body.classList.toggle('edit-mode', isEdit);
        render();
    }

    function switchTab(t, btn) {
        tab = t;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        if(btn) btn.classList.add('active');
        render();
    }

    function render() {
        const g = document.getElementById('grid');
        g.innerHTML = '';
        db[tab].forEach((item, i) => {
            const idPrefix = `${tab}-${i}`;
            g.innerHTML += `
                <div class="card">
                    <img src="${item.i}" alt="${escapeHtml(item.n)}">
                    <div class="admin-fields">
                        <input type="text" id="url-${idPrefix}" placeholder="Link foto ImgBB" value="${escapeHtml(item.i)}">
                        <div style="display:flex; gap:8px; justify-content:center; margin-top:6px;">
                            <button onclick="del(${i})" style="color:white; background:#ff3b30; border:none; padding:6px 10px; border-radius:6px; cursor:pointer;">Eliminar √≠tem</button>
                            <button onclick="saveSingle(${i})" style="background:#0071e3; color:white; border:none; padding:6px 10px; border-radius:6px; cursor:pointer;">Guardar</button>
                        </div>
                    </div>
                    <h3 id="n-${idPrefix}" contenteditable="${isEdit}">${escapeHtml(item.n)}</h3>
                    <span class="price">$<span id="p-${idPrefix}" contenteditable="${isEdit}">${item.p}</span></span>
                    <button class="btn-add" onclick="addToCart(${i})">Seleccionar</button>
                </div>`;
        });
    }

    function addToCart(i) {
        const item = db[tab][i];
        const key = tab + "_" + item.id;
        if(!cart[key]) cart[key] = { ...item, qty: 0 };
        cart[key].qty++;
        updateCart();
    }

    function removeFromCart(key) {
        delete cart[key];
        updateCart();
    }

    function updateCart() {
        const itemsDiv = document.getElementById('cart-items');
        let total = 0; let count = 0;
        itemsDiv.innerHTML = '';
        for (let k in cart) {
            let it = cart[k];
            total += it.qty * it.p; count++;
            itemsDiv.innerHTML += `
                <div class="cart-item">
                    <span>${it.qty}x ${escapeHtml(it.n)}</span>
                    <span>$${(it.qty * it.p).toFixed(2)} <span class="remove-btn" onclick="removeFromCart('${k}')">‚úï</span></span>
                </div>`;
        }
        document.getElementById('cart').style.display = count > 0 ? 'block' : 'none';
        document.getElementById('cart-total').innerText = `$${total.toFixed(2)}`;
    }

    function send() {
        const nom = document.getElementById('c-name').value || "Cliente";
        let msg = `üîê *VIPCELLUNLOCK*%0Aüë§ *Cliente:* ${nom}%0A%0A`;
        for (let k in cart) {
            let it = cart[k];
            msg += `‚Ä¢ ${it.qty}x ${it.n} = $${(it.qty * it.p).toFixed(2)}%0A`;
        }
        window.open(`https://wa.me/${tel}?text=${msg}`);
        cart = {}; updateCart();
    }

    function saveAll() {
        db[tab].forEach((item, i) => {
            const idPrefix = `${tab}-${i}`;
            const nEl = document.getElementById(`n-${idPrefix}`);
            const pEl = document.getElementById(`p-${idPrefix}`);
            const urlEl = document.getElementById(`url-${idPrefix}`);
            if(nEl) item.n = nEl.innerText.trim() || item.n;
            if(pEl) item.p = parseFloat(pEl.innerText) || 0;
            if(urlEl) item.i = urlEl.value.trim() || item.i;
        });
        localStorage.setItem('vip_db_v2', JSON.stringify(db));
        alert("¬°Guardado!");
        toggleEdit();
    }

    function saveSingle(i) {
        const idPrefix = `${tab}-${i}`;
        const nEl = document.getElementById(`n-${idPrefix}`);
        const pEl = document.getElementById(`p-${idPrefix}`);
        const urlEl = document.getElementById(`url-${idPrefix}`);
        const item = db[tab][i];
        if(nEl) item.n = nEl.innerText.trim() || item.n;
        if(pEl) item.p = parseFloat(pEl.innerText) || 0;
        if(urlEl) item.i = urlEl.value.trim() || item.i;
        localStorage.setItem('vip_db_v2', JSON.stringify(db));
        render();
    }

    function newItem() {
        db[tab].push({id: Date.now(), n: "Nuevo", p: 0, i: "https://via.placeholder.com/300"});
        render();
    }

    function del(i) { db[tab].splice(i, 1); localStorage.setItem('vip_db_v2', JSON.stringify(db)); render(); }

    // small helper to avoid XSS when injecting strings into HTML templates
    function escapeHtml(str) {
        return String(str)
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#039;");
    }

    render();
</script>
</body>
</html>